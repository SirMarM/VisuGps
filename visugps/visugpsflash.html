<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:v="urn:schemas-microsoft-com:vml">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
    <title>Carte du Vol</title>

    <style type="text/css">
    html, body {width: 100%; height: 100%}
    body {margin: 0px;}
    #map {width: 100%; height: 100%}
    </style>

    <script type="text/javascript" src="./lib/swfobject/swfobject.js"></script>

    <script>
        var trackName = decodeURIComponent(location.search) || 'noparam';
        var proxy = "http://victorb.fr/visugps/php/vg_proxy.php?";

        var isLive = /live=1/i.test(trackName)?1:0;

        if (m = /track=(.*)$/i.exec(trackName)) {
          trackName = proxy + "track=" + m[1];
        } else if (m = /trackid=(\d+)/i.exec(trackName)) {
          trackName = proxy + "trackid=" + m[1];
        } else {
          trackName = proxy + "track=" + location.href.replace(/[\w\.]*$/, 'test.igc');
        }
        
        swfobject.embedSWF("./flash/bin/vgpsflash.swf",
                           "map", 
                           "300", "200",
                           "9.0.0", 
                           "expressInstall.swf",
                           {trackUrl:trackName,
                            live:isLive});
    </script>

  </head>
  <body>
    <div id='map'>
        <p>Please install flash player v9</p>
    </div>
  </body>
</html>
